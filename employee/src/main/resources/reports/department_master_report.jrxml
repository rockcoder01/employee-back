<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports"
              xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
              xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd"
              name="DepartmentReport" pageWidth="595" pageHeight="842" columnCount="1">
    <!-- Parameters -->
    <parameter name="ReportTitle" class="java.lang.String"/>
    <parameter name="departmentList" class="java.util.List"/>

    <!-- Fields -->
    <field name="id" class="java.lang.Long"/>
    <field name="name" class="java.lang.String"/>
    <field name="employees" class="java.util.List"/>

    <!-- Variable for Group Index -->
    <variable name="DepartmentGroupIndex" class="java.lang.Integer" calculation="Count">
        <variableExpression><![CDATA[$F{id}]]></variableExpression>
    </variable>

    <!-- Group Definition -->
    <group name="DepartmentGroup">
        <groupExpression><![CDATA[$F{id}]]></groupExpression>
        <groupHeader>
            <band height="30">
                <textField>
                    <reportElement x="0" y="0" width="200" height="30"/>
                    <textElement>
                        <font size="14" isBold="true"/>
                    </textElement>
                    <textFieldExpression><![CDATA["Department: " + $F{name}]]></textFieldExpression>
                </textField>
            </band>
        </groupHeader>
        <groupFooter>
            <band height="20">
                <line>
                    <reportElement x="0" y="0" width="555" height="1"/>
                </line>
            </band>
        </groupFooter>
    </group>

    <!-- Detail Band for Employees -->
    <detail>
        <band height="20">
            <textField>
                <reportElement x="0" y="0" width="200" height="20"/>
                <textFieldExpression><![CDATA[
                    // Iterate through the employee list
                    $F{employees}.isEmpty() ? "No employees" :
                    ((com.employeemanagement.entities.Employee) $F{employees}.get(0)).getName()
                ]]></textFieldExpression>
            </textField>
        </band>
    </detail>
</jasperReport>
